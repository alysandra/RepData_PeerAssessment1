{
    "contents" : "---\ntitle: \"Reproducible Research Peer Assignement 1\"\noutput: html_document\n---\n\nThis is an assignment on answering a series of questions to practice loading data, cleaning it and interpreting data in a way that is clearly marked and presented on a html format. The data is collected from a [Fitbit](http://en.wikipedia.org/wiki/Fitbit).\n## Data\nThe data for this assignment was downloaded from the course web\nsite:\n\nDataset: [Activity monitoring data](https://d396qusza40orc.cloudfront.net/repdata%2Fdata%2Factivity.zip) [52K]\n\nThe variables included in this dataset are:\n\n1. steps: Number of steps taking in a 5-minute interval (missing\n    values are coded as `NA`)\n\n2. date: The date on which the measurement was taken in YYYY-MM-DD format\n\n3. interval: Identifier for the 5-minute interval in which measurement was taken\n\nThe dataset is stored in a comma-separated-value (CSV) file and there are a total of 17,568 observations in this dataset.\n\n\n## Part 1: Loading and preprocessing the data\n\n```{r}\ndata <- read.csv(\"~/mm/activity.csv\",  colClasses = c(\"numeric\", \"character\", \n                                                          \"numeric\"))\n\n```\n\n## Part 2: What is mean total number of steps taken per day?\n- Calculate the aggregate steps for all intervals sorted by day\n- Plot Total Steps by Day\n- Look for the interval with most steps.\n\n```{r}\nStepsTotal <- aggregate(steps ~ interval, data, mean)\ndailysteps <- aggregate(steps~date,data,sum)\n\nhist(dailysteps$steps, main = \"Total Steps By Day\", xlab = \"Number of Steps\", col = \"yellow\")\n\nmax_interval <- StepsTotal[which.max(StepsTotal$steps),1]\nmean(dailysteps$steps)\nmedian(dailysteps$steps)\n```\n\n##Part 3: What is the average daily activity pattern?\n\n###Use time series plot to check 5 minute intervals\nThe 5-minute interval, on average across all the days in the data set, containing the maximum number of steps is `r max_interval`.\n\n```{r}\ntime_series <- tapply(activity$steps, activity$interval, mean, na.rm = TRUE)\n\n##And plot: \nplot(row.names(time_series), time_series, type = \"l\", xlab = \"5-min interval\", \n     ylab = \"Average across all Days\", main = \"Average number of steps taken\", \n     col = \"red\")\n## to find max number of steps on average in a 5 min interval\nmax_interval <- which.max(time_series)\nnames(max_interval)\n```\n\nTherefore, the max number of steps taken on a 5 minute average in a day is 835.\n\n##Part 4: Imputing missing values\n\n###Find the number of missing values:\n\n```{r}\nempty <-sum(!complete.cases(data))\nnewdata <- transform(data, steps = ifelse(is.na(data$steps), StepsTotal$steps[match(data$interval, StepsTotal$interval)], data$steps))\nnewdata[as.character(newdata$date) == \"2012-10-01\", 1] <- 0\n```\nWe altered the original data by replacing NA values as 0.\n\nSo now with the filled in data, we can recount the information given.\n\n## To make it more comparable, here is a display of the changes that occurred due to the removal of \"NA\" figures, as shown in the blue parts in the histogram.\n```{r}\n\ndailysteps.2 <- aggregate(steps~date,newdata,sum)\nhist(dailysteps.2$steps, main = \"Total Steps by Day\", xlab = \"Number of Steps\", col=\"blue\")\n\nStepsTotal2 <- aggregate(steps ~ date, data = new_activity, sum, na.rm = TRUE)\nhist(StepsTotal2$steps, main = \"Total steps by day\", xlab = \"day\", col = \"blue\")\n\n\nhist(dailysteps$steps, main = paste(\"Total Steps Each Day\"), col=\"yellow\", xlab=\"Number of Steps\", add=T)\nlegend(\"topright\", c(\"Original\",\"Edited\"), col=c(\"yellow\", \"blue\"), lwd=10)\n\n##New Mean and median\n\nmean(dailysteps.2$steps)\n\nmedian(dailysteps.2$steps)\n\n```\n\nTo show the change in mean and median\n\n```{r}\nchange1<- mean(dailysteps.2$steps) - mean(dailysteps$steps)\nprint(change1)\nchange2<- median(dailysteps.2$steps) - median(dailysteps$steps)\nprint(change2)\n\nchange3 <- sum(dailysteps.2$steps) - sum(dailysteps$steps)\nprint(change3)\n```\n\n##Changes after edit\n` Mean changed by -176, \n` Median increased by 1.18. \n` There has also been 75363 steps added when the data is changed.\n\n\n## Part 5: Are there differences in activity patterns between weekdays and weekends?\n###Weekday versus weekend walking: differentiate between the two first, by sorting the data and adding a new column of either Weekday or Weekend\n```{r}\nweekdays <- c(\"Monday\", \"Tuesday\", \"Wednesday\", \"Thursday\", \"Friday\")\nnewdata$dow = as.factor(ifelse(is.element(weekdays(as.Date(newdata$date)),weekdays), \"Weekday\", \"Weekend\"))\n\nstepsint<- aggregate(steps ~ interval + dow, newdata, mean)\n\n```\n##Create the plot:\n```{r}\nlibrary(lattice)\n\nxyplot(stepsint$steps ~ stepsint$interval|stepsint$dow, layout= c(1,2), xlab=\"Interval\", ylab=\"Steps\", main=\"Average Steps per day by interval\", type = \"l\", col=\"pink\")\n\n```\n\n",
    "created" : 1439811924919.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "3025508240",
    "id" : "720F53C3",
    "lastKnownWriteTime" : 1442749586,
    "path" : "~/My Data Sources/ExData_Plotting1/RepData_PeerAssessment1/PA1_template.Rmd",
    "project_path" : "PA1_template.Rmd",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "source_on_save" : false,
    "type" : "r_markdown"
}